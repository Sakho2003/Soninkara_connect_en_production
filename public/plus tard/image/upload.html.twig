{% extends '@EasyAdmin/page/content.html.twig' %}

{% block title %}Téléverser une Image{% endblock %}

{% block body %}
    <div class="container mt-4">
        <h1 class="mb-4">Téléverser une Image</h1>

        {% for message in app.flashes('success') %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}

        {% for message in app.flashes('error') %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}

        <form method="post" action="{{ path('app_image_upload') }}" enctype="multipart/form-data">
            <div class="form-group">
                <label for="imageFile">Choisir une image</label>
                <input type="file" id="imageFile" name="imageFile" class="form-control-file" required>
            </div>
            
            <div class="form-group">
                <label>Aperçu de l'image :</label>
                <div id="imagePreview" class="border p-2"></div>
            </div>

            <button type="submit" class="btn btn-primary">Téléverser</button>
        </form>
    </div>

    <script>
        document.getElementById('imageFile').addEventListener('change', function (e) {
            const imagePreview = document.getElementById('imagePreview');
            const file = e.target.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.maxWidth = '100%';
                    img.style.maxHeight = '200px';
                    img.classList.add('img-thumbnail');
                    imagePreview.innerHTML = '';
                    imagePreview.appendChild(img);
                };
                reader.readAsDataURL(file);
            } else {
                imagePreview.innerHTML = '<p class="text-muted">Aucune image sélectionnée.</p>';
            }
        });
    </script>
{% endblock %}
